# Huawei Storage Script Generator

This Python application generates scripts for Huawei Storage devices (both Dorado and Pacific series) based on user input provided via Excel files and a JSON configuration. The application dynamically adapts to changes in the JSON file, making it highly customizable and scalable.

## Features

* **Multi-Platform Support** : Generates commands for both Dorado and Pacific storage devices
* **Excel Import Functionality** : Import Excel files from InfoGrab to replicate all commands of a storage device
* **Dynamic Configuration** : The application reads from a JSON file to determine available resource types (e.g., CIFS, NFS, FileSystem) and their associated commands
* **Excel-Based Input** : Users can input data via Excel files, which are automatically generated by the application
* **User-Friendly GUI** : Provides a graphical user interface for easy interaction
* **Executable Packaging** : Can be packaged into an executable (.exe) file for easy distribution

## Getting Started

### Prerequisites

* Python 3.x
* Required Python packages (install via pip):

  ```
  pip install pandas openpyxl tkinter pillow
  ```

### Running the Application

#### Clone the Repository:

```
git clone https://github.com/javimcasas/huawei-storage-script-generator.git
cd huawei-storage-script-generator
```

#### Launch the Application:

Run the `main.py` script to start the application:

```
python main.py
```

## Using the Application

1. Select a resource type (e.g., CIFS, NFS, FileSystem) from the dropdown menu
2. Choose a command type (e.g., Create, Change, Show)
3. Click **Open Excel** to generate and open an Excel file for data input
4. Fill out the Excel file with the required data
5. Click **Run Script** to generate the commands (output saved in `Results` folder)
6. Use **Import Excel** to import configurations from InfoGrab Excel files

### New Import Excel Functionality

The application now supports importing Excel files generated by InfoGrab to:

* Replicate entire storage configurations
* Migrate configurations between devices
* Bulk generate commands for existing setups

## JSON Configuration

The application dynamically adapts to changes in the `commands_config.json` file. This file defines:

* Available resource types (e.g., CIFS, NFS, FileSystem)
* Commands associated with each resource type (e.g., Create, Change, Show)
* Mandatory and optional fields for each command
* Platform-specific variations (Dorado vs Pacific)

### Example JSON structure:

```
{
    "CIFS": {
        "platform": ["dorado", "pacific"],
        "Create": {
            "mandatory": [
                {
                    "name": "name",
                    "field_type": "text"
                },
                {
                    "name": "local_path",
                    "field_type": "text",
                    "platform_specific": {
                        "dorado": "path",
                        "pacific": "local_path"
                    }
                }
            ],
            "optional": [
                {
                    "name": "oplock_enabled",
                    "field_type": "select",
                    "allowed_values": ["yes", "no"],
                    "default": "yes"
                }
            ]
        }
    }
}
```

## Packaging the Application

To create an executable (.exe) file:

### Install PyInstaller:

```
pip install pyinstaller
```

### Create the Executable:

Run the `exe_creator.py` script:

```
python exe_creator.py
```

The executable will be created in the `dist` folder.

## File Structure

```
huawei-storage-script-generator/
├── script_selector.py          # Main application script
├── command_generator.py        # Script to generate the commands
├── gui_helpers.py              # Script to manage GUI style
├── file_operations.py          # Script to create and manage the xlsx files
├── utils.py                    # Script to manage general functions
├── excel_importer.py           # Script to handle InfoGrab imports
├── exe_creator.py              # Script to create an executable
├── commands_config.json        # JSON configuration file
├── Icons/                      # Folder for application icons
│   └── help.ico                # Help button icon
├── Documents/                  # Folder for generated Excel files
├── Results/                    # Folder for generated script files
├── Imported_Results/           # Folder for imported configurations
└── README.md                   # Project documentation
```

## Contributing

Contributions are welcome! Please follow these steps:

1. Fork the repository
2. Create a new branch (`git checkout -b feature/YourFeature`)
3. Commit your changes (`git commit -m 'Add some feature'`)
4. Push to the branch (`git push origin feature/YourFeature`)
5. Open a pull request

## License

This project is licensed under the MIT License - see the **LICENSE** file for details.
